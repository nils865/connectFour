var pe=Object.defineProperty;var _e=(e,t,n)=>t in e?pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var _=(e,t,n)=>(_e(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(s){if(s.ep)return;s.ep=!0;const c=n(s);fetch(s.href,c)}})();function p(){}function le(e){return e()}function J(){return Object.create(null)}function E(e){e.forEach(le)}function oe(e){return typeof e=="function"}function R(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let D;function ye(e,t){return D||(D=document.createElement("a")),D.href=t,e===D.href}function Ce(e){return Object.keys(e).length===0}function we(e,...t){if(e==null)return p;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function I(e,t,n){e.$$.on_destroy.push(we(t,n))}function Q(e,t,n){return e.set(n),t}function m(e,t){e.appendChild(t)}function W(e,t,n){e.insertBefore(t,n||null)}function A(e){e.parentNode&&e.parentNode.removeChild(e)}function re(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function g(e){return document.createElement(e)}function ve(e){return document.createTextNode(e)}function M(){return ve(" ")}function B(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function d(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function be(e){return Array.from(e.childNodes)}function U(e,t){for(let n=0;n<e.options.length;n+=1){const i=e.options[n];if(i.__value===t){i.selected=!0;return}}e.selectedIndex=-1}function Se(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}let z;function k(e){z=e}const S=[],V=[],N=[],X=[],$e=Promise.resolve();let H=!1;function xe(){H||(H=!0,$e.then(ce))}function O(e){N.push(e)}const F=new Set;let v=0;function ce(){if(v!==0)return;const e=z;do{try{for(;v<S.length;){const t=S[v];v++,k(t),Le(t.$$)}}catch(t){throw S.length=0,v=0,t}for(k(null),S.length=0,v=0;V.length;)V.pop()();for(let t=0;t<N.length;t+=1){const n=N[t];F.has(n)||(F.add(n),n())}N.length=0}while(S.length);for(;X.length;)X.pop()();H=!1,F.clear(),k(e)}function Le(e){if(e.fragment!==null){e.update(),E(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(O)}}const G=new Set;let Ie;function ue(e,t){e&&e.i&&(G.delete(e),e.i(t))}function ke(e,t,n,i){if(e&&e.o){if(G.has(e))return;G.add(e),Ie.c.push(()=>{G.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}else i&&i()}function Ee(e){e&&e.c()}function ae(e,t,n,i){const{fragment:s,after_update:c}=e.$$;s&&s.m(t,n),i||O(()=>{const o=e.$$.on_mount.map(le).filter(oe);e.$$.on_destroy?e.$$.on_destroy.push(...o):E(o),e.$$.on_mount=[]}),c.forEach(O)}function de(e,t){const n=e.$$;n.fragment!==null&&(E(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ae(e,t){e.$$.dirty[0]===-1&&(S.push(e),xe(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function fe(e,t,n,i,s,c,o,r=[-1]){const u=z;k(e);const l=e.$$={fragment:null,ctx:[],props:c,update:p,not_equal:s,bound:J(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:J(),dirty:r,skip_bound:!1,root:t.target||u.$$.root};o&&o(l.root);let a=!1;if(l.ctx=n?n(e,t.props||{},(f,y,...L)=>{const h=L.length?L[0]:y;return l.ctx&&s(l.ctx[f],l.ctx[f]=h)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](h),a&&Ae(e,f)),y}):[],l.update(),a=!0,E(l.before_update),l.fragment=i?i(l.ctx):!1,t.target){if(t.hydrate){const f=be(t.target);l.fragment&&l.fragment.l(f),f.forEach(A)}else l.fragment&&l.fragment.c();t.intro&&ue(e.$$.fragment),ae(e,t.target,t.anchor,t.customElement),ce()}k(u)}class he{$destroy(){de(this,1),this.$destroy=p}$on(t,n){if(!oe(n))return p;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const s=i.indexOf(n);s!==-1&&i.splice(s,1)}}$set(t){this.$$set&&!Ce(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const b=[];function j(e,t=p){let n;const i=new Set;function s(r){if(R(e,r)&&(e=r,n)){const u=!b.length;for(const l of i)l[1](),b.push(l,e);if(u){for(let l=0;l<b.length;l+=2)b[l][0](b[l+1]);b.length=0}}}function c(r){s(r(e))}function o(r,u=p){const l=[r,u];return i.add(l),i.size===1&&(n=t(s)||p),r(e),()=>{i.delete(l),i.size===0&&(n(),n=null)}}return{set:s,update:c,subscribe:o}}const $=j(`It's <span style="color: red">reds</span> turn`),K=j(!1),x=j("redCoin"),P=j("twoPlayer"),w=7,Y=6;function me(){const e=document.createElement("div");for(let n=0;n<w;n++){const i=document.createElement("div");i.classList.add("column"),i.id=`column${n}`,e.appendChild(i)}const t=document.getElementsByClassName("column");for(let n=0;n<t.length;n++)for(let i=0;i<t[n].children.length;i++){const s=document.createElement("div");s.classList.add("slot");const c=document.createElement("div");C(t[n].children[i])!=null&&c.classList.add("coin",`${C(t[n].children[i])}`),s.appendChild(c),e.children[n].appendChild(s)}return e.children}function De(e){const t=document.getElementsByClassName("column");for(let n=0;n<t.length;n++){const i=t[n].children;for(let s=0;s<i.length;s++){const c=i[s].children[0];e(c)}}}function Be(e){return e.children[0].children[0].classList.contains("coin")}function Ne(){let e=null;x.subscribe(t=>e=t),e==="redCoin"?x.set("yellowCoin"):x.set("redCoin")}function Z(){K.set(!1),x.set("redCoin"),$.set(`It's <span style="color: red">reds</span> turn`),De(e=>{e.classList.remove("coin"),e.classList.remove("blink"),e.classList.contains("redCoin")?e.classList.remove("redCoin"):e.classList.contains("yellowCoin")&&e.classList.remove("yellowCoin")})}function C(e){return e.children[0].classList.contains("redCoin")?"redCoin":e.children[0].classList.contains("yellowCoin")?"yellowCoin":null}function T(e){const t=e.children;for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.children[0].classList.contains("coin"))continue;let s=null;x.subscribe(o=>s=o),i.children[0].classList.add(s),i.children[0].classList.add("coin");const c={children:t,index:n};return Ne(),c}}function ee(e){const t=new ge(e.children[e.index],me()),n=t.WinState;return n.state&&(K.set(!0),t.addBlink(),n.winner==="redCoin"?$.set('<span style="color: red">Red</span> won!'):n.winner==="yellowCoin"&&$.set('<span style="color: yellow">Yellow</span> won!')),t.WinState}class ge{constructor(t,n){_(this,"output");_(this,"lastCoin");_(this,"columns");_(this,"connectedElements");this.output={state:!1,elements:[],winner:null},this.lastCoin=new ne(t),this.columns=n,this.connectedElements=[this.checkColumn(),this.checkRow(),this.checkDiagonal(i=>({x:i.x+1,y:i.y-1}),i=>({x:i.x-1,y:i.y+1})),this.checkDiagonal(i=>({x:i.x-1,y:i.y-1}),i=>({x:i.x+1,y:i.y+1}))],this.connectedElements.forEach(i=>{i.length>=4&&(this.output.state=!0,this.output.winner=this.lastCoin.State,i.forEach(s=>{this.output.elements.includes(s)||this.output.elements.push(s)}))})}addBlink(){this.output.elements.forEach(t=>{const n=new ne(t);document.getElementsByClassName("column")[n.ColumnId].children[n.SlotId].children[0].classList.add("blink")})}get WinState(){return this.output}get ConnectedElements(){return this.connectedElements}checkColumn(){let t=[];for(let n=this.lastCoin.SlotId;n<Y&&this.lastCoin.State==C(this.columns[this.lastCoin.ColumnId].children[n]);n++)t.push(this.getSlot({x:this.lastCoin.ColumnId,y:n}));return t}checkRow(){let t=[],n=-1;for(let i=this.lastCoin.ColumnId;i>=0&&n<0;i--)this.lastCoin.State!=C(this.getSlot({x:i,y:this.lastCoin.SlotId}))&&(n=i);n++;for(let i=n;i<w&&this.lastCoin.State===C(this.getSlot({x:i,y:this.lastCoin.SlotId}));i++)t.push(this.getSlot({x:i,y:this.lastCoin.SlotId}));return t}checkDiagonal(t,n){let i=[];const s={x:this.lastCoin.ColumnId,y:this.lastCoin.SlotId};let c=t(s);for(;te(n(c))&&C(this.getSlot(n(c)))===this.lastCoin.State;)c=n(c);let o=n(c);for(;te(t(o))&&C(this.getSlot(t(o)))==this.lastCoin.State;)o=t(o),i.push(this.getSlot(o));return i}getSlot(t){return this.columns[t.x].children[t.y]}}const te=e=>e.x<w&&e.x>=0&&e.y<Y&&e.y>=0;class ne{constructor(t){_(this,"element");_(this,"slotId");_(this,"columnId");_(this,"state");this.element=t,this.columnId=parseInt(this.element.parentElement.id[this.element.parentElement.id.length-1]),this.calcSlotId(),this.calcState()}get Element(){return this.element}get SlotId(){return this.slotId}get ColumnId(){return this.columnId}get State(){return this.state}calcSlotId(){const t=this.element.parentElement;for(let n=0;n<t.children.length;n++)if(t.children[n]==this.element){this.slotId=n;break}}calcState(){this.element.children[0].classList.contains("yellowCoin")?this.state="yellowCoin":this.element.children[0].classList.contains("redCoin")?this.state="redCoin":this.state=null}}class Ge{constructor(){_(this,"columns");this.columns=document.getElementsByClassName("column")}spawnCoin(){const t=this.checkForDefense();if(t>-1)return T(this.columns[t]);const n=Math.floor(Math.random()*w);return Be(this.columns[n])?this.spawnCoin():T(this.columns[n])}checkForDefense(){for(let t=0;t<w;t++){const n=this.generateGamefield(t);if(n===null)continue;if(new ge(n.slot,n.field).WinState.state)return t}return-1}generateGamefield(t){const n=me();let i=-1;for(let s=0;s<n[t].children.length;s++)n[t].children[s].children[0].classList.contains("coin")||(i=s);return i<=-1?null:(n[t].children[i].children[0].classList.add("coin","redCoin"),{slot:n[t].children[i],field:n})}}function ie(e,t,n){const i=e.slice();return i[6]=t[n],i[8]=n,i}function Me(e,t,n){const i=e.slice();return i[6]=t[n],i}function Oe(e){let t;return{c(){t=g("div"),t.innerHTML="<div></div>",d(t,"class","slot svelte-i4tv32")},m(n,i){W(n,t,i)},p,d(n){n&&A(t)}}}function se(e){let t,n,i,s,c=Array(Y),o=[];for(let r=0;r<c.length;r+=1)o[r]=Oe(Me(e,c,r));return{c(){t=g("div");for(let r=0;r<o.length;r+=1)o[r].c();n=M(),d(t,"id","column"+e[8]),d(t,"class","column svelte-i4tv32")},m(r,u){W(r,t,u);for(let l=0;l<o.length;l+=1)o[l].m(t,null);m(t,n),i||(s=B(t,"click",e[1]),i=!0)},p,d(r){r&&A(t),re(o,r),i=!1,s()}}}function We(e){let t,n,i,s,c=Array(w),o=[];for(let r=0;r<c.length;r+=1)o[r]=se(ie(e,c,r));return{c(){t=g("div"),n=g("h1"),i=M(),s=g("div");for(let r=0;r<o.length;r+=1)o[r].c();d(n,"class","svelte-i4tv32"),d(s,"id","gamefield"),d(s,"class","svelte-i4tv32")},m(r,u){W(r,t,u),m(t,n),n.innerHTML=e[0],m(t,i),m(t,s);for(let l=0;l<o.length;l+=1)o[l].m(s,null)},p(r,[u]){if(u&1&&(n.innerHTML=r[0]),u&2){c=Array(w);let l;for(l=0;l<c.length;l+=1){const a=ie(r,c,l);o[l]?o[l].p(a,u):(o[l]=se(a),o[l].c(),o[l].m(s,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=c.length}},i:p,o:p,d(r){r&&A(t),re(o,r)}}}function je(e,t,n){let i,s,c,o;I(e,$,l=>n(0,i=l)),I(e,x,l=>n(2,s=l)),I(e,K,l=>n(3,c=l)),I(e,P,l=>n(4,o=l));const r=new Ge;function u(l){if(c)return;let a=l.target;if(a.classList.contains("coin")&&(a=a.parentElement),a.classList.contains("slot")&&(a=a.parentElement),a.classList.contains("column")&&a.id.startsWith("column")){const f=T(a);if(f==null)return;!ee(f).state&&o=="onePlayer"&&ee(r.spawnCoin())}else return;c||(s=="redCoin"?Q($,i=`It's <span style="color: red">reds</span> turn`,i):s=="yellowCoin"&&Q($,i=`It's <span style="color: yellow">yellows</span> turn`,i))}return[i,u]}class qe extends he{constructor(t){super(),fe(this,t,je,We,R,{})}}function Fe(e){let t,n,i,s,c,o,r,u,l,a,f,y,L;return a=new qe({}),{c(){t=g("div"),n=g("div"),i=g("img"),c=M(),o=g("select"),r=g("option"),r.textContent="2p",u=g("option"),u.textContent="1p",l=M(),Ee(a.$$.fragment),d(i,"id","refresh"),ye(i.src,s="./img/refresh.svg")||d(i,"src",s),d(i,"alt","refresh"),d(i,"draggable","false"),d(i,"class","svelte-1nn4l1m"),r.__value="twoPlayer",r.value=r.__value,u.__value="onePlayer",u.value=u.__value,d(o,"name","mode"),d(o,"id","mode"),d(o,"class","svelte-1nn4l1m"),e[0]===void 0&&O(()=>e[3].call(o)),d(n,"id","globalHead"),d(n,"class","svelte-1nn4l1m"),d(t,"id","mainPage"),d(t,"class","svelte-1nn4l1m")},m(h,q){W(h,t,q),m(t,n),m(n,i),m(n,c),m(n,o),m(o,r),m(o,u),U(o,e[0]),m(t,l),ae(a,t,null),f=!0,y||(L=[B(i,"click",e[1]),B(o,"change",e[2]),B(o,"change",e[3])],y=!0)},p(h,[q]){q&1&&U(o,h[0])},i(h){f||(ue(a.$$.fragment,h),f=!0)},o(h){ke(a.$$.fragment,h),f=!1},d(h){h&&A(t),de(a),y=!1,E(L)}}}function He(e,t,n){let i;I(e,P,r=>n(0,i=r));const s=()=>Z(),c=()=>Z();function o(){i=Se(this),P.set(i)}return[i,s,c,o]}class Pe extends he{constructor(t){super(),fe(this,t,He,Fe,R,{})}}new Pe({target:document.getElementById("app")});
