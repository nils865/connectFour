var $e=Object.defineProperty;var Se=(n,e,t)=>e in n?$e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var y=(n,e,t)=>(Se(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerpolicy&&(s.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?s.credentials="include":l.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(l){if(l.ep)return;l.ep=!0;const s=t(l);fetch(l.href,s)}})();function h(){}function ye(n){return n()}function ie(){return Object.create(null)}function W(n){n.forEach(ye)}function Ce(n){return typeof n=="function"}function q(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let D;function Le(n,e){return D||(D=document.createElement("a")),D.href=e,n===D.href}function xe(n){return Object.keys(n).length===0}function ke(n,...e){if(n==null)return h;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function A(n,e,t){n.$$.on_destroy.push(ke(e,t))}function le(n,e,t){return n.set(t),e}function m(n,e){n.appendChild(e)}function B(n,e,t){n.insertBefore(e,t||null)}function I(n){n.parentNode&&n.parentNode.removeChild(n)}function we(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function g(n){return document.createElement(n)}function Ee(n){return document.createTextNode(n)}function j(){return Ee(" ")}function G(n,e,t,i){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)}function u(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Ie(n){return Array.from(n.childNodes)}function se(n,e){for(let t=0;t<n.options.length;t+=1){const i=n.options[t];if(i.__value===e){i.selected=!0;return}}n.selectedIndex=-1}function Ae(n){const e=n.querySelector(":checked")||n.options[0];return e&&e.__value}let X;function F(n){X=n}const L=[],oe=[],M=[],re=[],je=Promise.resolve();let Y=!1;function Fe(){Y||(Y=!0,je.then(ve))}function P(n){M.push(n)}const z=new Set;let $=0;function ve(){if($!==0)return;const n=X;do{try{for(;$<L.length;){const e=L[$];$++,F(e),We(e.$$)}}catch(e){throw L.length=0,$=0,e}for(F(null),L.length=0,$=0;oe.length;)oe.pop()();for(let e=0;e<M.length;e+=1){const t=M[e];z.has(t)||(z.add(t),t())}M.length=0}while(L.length);for(;re.length;)re.pop()();Y=!1,z.clear(),F(n)}function We(n){if(n.fragment!==null){n.update(),W(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(P)}}const N=new Set;let Be;function K(n,e){n&&n.i&&(N.delete(n),n.i(e))}function ce(n,e,t,i){if(n&&n.o){if(N.has(n))return;N.add(n),Be.c.push(()=>{N.delete(n),i&&(t&&n.d(1),i())}),n.o(e)}else i&&i()}function de(n){n&&n.c()}function V(n,e,t,i){const{fragment:l,after_update:s}=n.$$;l&&l.m(e,t),i||P(()=>{const o=n.$$.on_mount.map(ye).filter(Ce);n.$$.on_destroy?n.$$.on_destroy.push(...o):W(o),n.$$.on_mount=[]}),s.forEach(P)}function J(n,e){const t=n.$$;t.fragment!==null&&(W(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function De(n,e){n.$$.dirty[0]===-1&&(L.push(n),Fe(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Z(n,e,t,i,l,s,o,c=[-1]){const d=X;F(n);const r=n.$$={fragment:null,ctx:[],props:s,update:h,not_equal:l,bound:ie(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:ie(),dirty:c,skip_bound:!1,root:e.target||d.$$.root};o&&o(r.root);let a=!1;if(r.ctx=t?t(n,e.props||{},(f,w,...C)=>{const v=C.length?C[0]:w;return r.ctx&&l(r.ctx[f],r.ctx[f]=v)&&(!r.skip_bound&&r.bound[f]&&r.bound[f](v),a&&De(n,f)),w}):[],r.update(),a=!0,W(r.before_update),r.fragment=i?i(r.ctx):!1,e.target){if(e.hydrate){const f=Ie(e.target);r.fragment&&r.fragment.l(f),f.forEach(I)}else r.fragment&&r.fragment.c();e.intro&&K(n.$$.fragment),V(n,e.target,e.anchor,e.customElement),ve()}F(d)}class ee{$destroy(){J(this,1),this.$destroy=h}$on(e,t){if(!Ce(t))return h;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const l=i.indexOf(t);l!==-1&&i.splice(l,1)}}$set(e){this.$$set&&!xe(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const S=[];function H(n,e=h){let t;const i=new Set;function l(c){if(q(n,c)&&(n=c,t)){const d=!S.length;for(const r of i)r[1](),S.push(r,n);if(d){for(let r=0;r<S.length;r+=2)S[r][0](S[r+1]);S.length=0}}}function s(c){l(c(n))}function o(c,d=h){const r=[c,d];return i.add(r),i.size===1&&(t=e(l)||h),c(n),()=>{i.delete(r),i.size===0&&(t(),t=null)}}return{set:l,update:s,subscribe:o}}const x=H(`It's <span style="color: red">reds</span> turn`),te=H(!1),k=H("redCoin"),Q=H("twoPlayer"),p=7,E=6;function be(){const n=document.createElement("div");for(let t=0;t<p;t++){const i=document.createElement("div");i.classList.add("column"),i.id=`column${t}`,n.appendChild(i)}const e=document.getElementsByClassName("column");for(let t=0;t<e.length;t++)for(let i=0;i<e[t].children.length;i++){const l=document.createElement("div");l.classList.add("slot");const s=document.createElement("div");b(e[t].children[i])!=null&&s.classList.add("coin",`${b(e[t].children[i])}`),l.appendChild(s),n.children[t].appendChild(l)}return n.children}function Ge(n){const e=document.getElementsByClassName("column");for(let t=0;t<e.length;t++){const i=e[t].children;for(let l=0;l<i.length;l++){const s=i[l].children[0];n(s)}}}function ae(n){return n.children[0].children[0].classList.contains("coin")}function Me(){let n=null;k.subscribe(e=>n=e),n==="redCoin"?k.set("yellowCoin"):k.set("redCoin")}function ue(){te.set(!1),k.set("redCoin"),x.set(`It's <span style="color: red">reds</span> turn`),console.clear(),Ge(n=>{n.classList.remove("coin"),n.classList.remove("blink"),n.classList.contains("redCoin")?n.classList.remove("redCoin"):n.classList.contains("yellowCoin")&&n.classList.remove("yellowCoin")})}function b(n){return n.children[0].classList.contains("redCoin")?"redCoin":n.children[0].classList.contains("yellowCoin")?"yellowCoin":null}function U(n){const e=n.children;for(let t=e.length-1;t>=0;t--){const i=e[t];if(i.children[0].classList.contains("coin"))continue;let l=null;k.subscribe(o=>l=o),i.children[0].classList.add(l),i.children[0].classList.add("coin");const s={children:e,index:t};return Me(),s}}class fe{constructor(){y(this,"field");this.field=document.createElement("div"),this.addColumns()}get Field(){return this.field.children}getSlot(e,t){if(t==="top"){for(let i=0;i<this.field.children[e].children.length;i++)if(this.field.children[e].children[i].children[0].classList.contains("coin")){t=i;break}}return{element:this.field.children[e].children[t],column:e,row:t}}showField(){const e=new Array(E).fill("");for(let t=0;t<p;t++){const i=this.field.children[t];for(let l=0;l<E;l++){let s=i.children[l].children[0].classList;s.contains("redCoin")?e[l]+="R ":s.contains("yellowCoin")?e[l]+="Y ":e[l]+=`${l} `}}console.log(`
---------------------------
`),e.forEach(t=>{console.log(t)})}edit(e,t,i){if(t==="top")for(let s=0;s<this.field.children[e].children.length;s++)this.field.children[e].children[s].children[0].classList.contains("coin")||(t=s);t=t==="top"?0:t;const l=this.field.children[e].children[t].children[0].classList;l.add(i),l.add("coin")}fill(e){for(let t=0;t<e.length;t++){const i=e[t];for(let l=0;l<i.children.length;l++){const s=i.children[l].children[0].classList;s.contains("redCoin")?(this.field.children[t].children[l].children[0].classList.add("coin"),this.field.children[t].children[l].children[0].classList.add("redCoin")):s.contains("yellowCoin")&&(this.field.children[t].children[l].children[0].classList.add("coin"),this.field.children[t].children[l].children[0].classList.add("yellowCoin"))}}}addColumns(){for(let e=0;e<p;e++){const t=document.createElement("div");t.classList.add("column"),t.id=`column${e}`,this.field.appendChild(t),this.addSlots(e)}}addSlots(e){for(let t=0;t<E;t++){const i=document.createElement("div");i.classList.add("slot"),i.appendChild(document.createElement("div")),this.field.children[e].appendChild(i)}}}function he(n){const e=new O(n.children[n.index],be()),t=e.WinState;return t.state&&(te.set(!0),e.addBlink(),t.winner==="redCoin"?x.set('<span style="color: red">Red</span> won!'):t.winner==="yellowCoin"&&x.set('<span style="color: yellow">Yellow</span> won!')),e.WinState}class O{constructor(e,t){y(this,"output");y(this,"lastCoin");y(this,"columns");y(this,"connectedElements");this.output={state:!1,elements:[],winner:null},this.lastCoin=new ge(e),this.columns=t,this.connectedElements=[this.checkColumn(),this.checkRow(),this.checkDiagonal(i=>({x:i.x+1,y:i.y-1}),i=>({x:i.x-1,y:i.y+1})),this.checkDiagonal(i=>({x:i.x-1,y:i.y-1}),i=>({x:i.x+1,y:i.y+1}))],this.connectedElements.forEach(i=>{i.length>=4&&(this.output.state=!0,this.output.winner=this.lastCoin.State,i.forEach(l=>{this.output.elements.includes(l)||this.output.elements.push(l)}))})}addBlink(){this.output.elements.forEach(e=>{const t=new ge(e);document.getElementsByClassName("column")[t.ColumnId].children[t.SlotId].children[0].classList.add("blink")})}get WinState(){return this.output}get ConnectedElements(){return this.connectedElements}checkColumn(){let e=[];for(let t=this.lastCoin.SlotId;t<E&&this.lastCoin.State==b(this.columns[this.lastCoin.ColumnId].children[t]);t++)e.push(this.getSlot({x:this.lastCoin.ColumnId,y:t}));return e}checkRow(){let e=[],t=-1;for(let i=this.lastCoin.ColumnId;i>=0&&t<0;i--)this.lastCoin.State!=b(this.getSlot({x:i,y:this.lastCoin.SlotId}))&&(t=i);t++;for(let i=t;i<p&&this.lastCoin.State===b(this.getSlot({x:i,y:this.lastCoin.SlotId}));i++)e.push(this.getSlot({x:i,y:this.lastCoin.SlotId}));return e}checkDiagonal(e,t){let i=[];const l={x:this.lastCoin.ColumnId,y:this.lastCoin.SlotId};let s=e(l);for(;me(t(s))&&b(this.getSlot(t(s)))===this.lastCoin.State;)s=t(s);let o=t(s);for(;me(e(o))&&b(this.getSlot(e(o)))==this.lastCoin.State;)o=e(o),i.push(this.getSlot(o));return i}getSlot(e){return this.columns[e.x].children[e.y]}}const me=n=>n.x<p&&n.x>=0&&n.y<E&&n.y>=0;class ge{constructor(e){y(this,"element");y(this,"slotId");y(this,"columnId");y(this,"state");this.element=e,this.columnId=parseInt(this.element.parentElement.id[this.element.parentElement.id.length-1]),this.calcSlotId(),this.calcState()}get Element(){return this.element}get SlotId(){return this.slotId}get ColumnId(){return this.columnId}get State(){return this.state}calcSlotId(){const e=this.element.parentElement;for(let t=0;t<e.children.length;t++)if(e.children[t]==this.element){this.slotId=t;break}}calcState(){this.element.children[0].classList.contains("yellowCoin")?this.state="yellowCoin":this.element.children[0].classList.contains("redCoin")?this.state="redCoin":this.state=null}}class Ne{constructor(){y(this,"columns");this.columns=document.getElementsByClassName("column")}spawnCoin(){const e=this.checkForWin("yellowCoin");if(e!=null)return e;const t=this.checkForWin("redCoin");if(t!=null)return t;const i=this.generateBestPos();if(i>=0){const l=U(this.columns[i]);return l===void 0?this.spawnCoin():l}}generateBestPos(){const e=Array.from({length:p},()=>({field:new fe,id:0})).filter((l,s)=>ae(this.columns[s])||(l.id=s,l.field.fill(document.getElementsByClassName("column")),l.field.edit(s,"top","yellowCoin"),new O(l.field.getSlot(s,"top").element,l.field.Field).WinState.state)?null:l);let t=Array.from({length:e.length},()=>({move:null,children:[]})).filter((l,s)=>{if(l.move=e[s].field,l.id=e[s].id,l.children=Array.from({length:p},()=>new fe),l.children=l.children.filter((o,c)=>(o.fill(l.move.Field),o.edit(c,"top","redCoin"),new O(o.getSlot(c,"top").element,o.Field).WinState.state?null:o)),console.log(l.children.length),l.children.length<=0){for(let o=0;o<p;o++)if(!ae(this.columns[o]))return o}return l.children.length<p?null:l});return t[Math.floor(Math.random()*t.length)].id}checkForWin(e){for(let t=0;t<p;t++){const i=this.generateGamefield(be(),t,e);if(i===null)continue;if(new O(i.slot,i.field).WinState.state)return U(this.columns[t])}return null}generateGamefield(e,t,i){let l=-1;for(let s=0;s<e[t].children.length;s++)e[t].children[s].children[0].classList.contains("coin")||(l=s);return l<=-1?null:(e[t].children[l].children[0].classList.add("coin",`${i}`),{slot:e[t].children[l],field:e})}}function pe(n,e,t){const i=n.slice();return i[6]=e[t],i[8]=t,i}function Oe(n,e,t){const i=n.slice();return i[6]=e[t],i}function Pe(n){let e;return{c(){e=g("div"),e.innerHTML="<div></div>",u(e,"class","slot svelte-1jinsgt")},m(t,i){B(t,e,i)},p:h,d(t){t&&I(e)}}}function _e(n){let e,t,i,l,s=Array(E),o=[];for(let c=0;c<s.length;c+=1)o[c]=Pe(Oe(n,s,c));return{c(){e=g("div");for(let c=0;c<o.length;c+=1)o[c].c();t=j(),u(e,"id","column"+n[8]),u(e,"class","column svelte-1jinsgt")},m(c,d){B(c,e,d);for(let r=0;r<o.length;r+=1)o[r].m(e,null);m(e,t),i||(l=G(e,"click",n[1]),i=!0)},p:h,d(c){c&&I(e),we(o,c),i=!1,l()}}}function qe(n){let e,t,i,l,s=Array(p),o=[];for(let c=0;c<s.length;c+=1)o[c]=_e(pe(n,s,c));return{c(){e=g("div"),t=g("h1"),i=j(),l=g("div");for(let c=0;c<o.length;c+=1)o[c].c();u(t,"class","svelte-1jinsgt"),u(l,"id","gamefield"),u(l,"class","svelte-1jinsgt")},m(c,d){B(c,e,d),m(e,t),t.innerHTML=n[0],m(e,i),m(e,l);for(let r=0;r<o.length;r+=1)o[r].m(l,null)},p(c,[d]){if(d&1&&(t.innerHTML=c[0]),d&2){s=Array(p);let r;for(r=0;r<s.length;r+=1){const a=pe(c,s,r);o[r]?o[r].p(a,d):(o[r]=_e(a),o[r].c(),o[r].m(l,null))}for(;r<o.length;r+=1)o[r].d(1);o.length=s.length}},i:h,o:h,d(c){c&&I(e),we(o,c)}}}function He(n,e,t){let i,l,s,o;A(n,x,r=>t(0,i=r)),A(n,k,r=>t(2,l=r)),A(n,te,r=>t(3,s=r)),A(n,Q,r=>t(4,o=r));const c=new Ne;function d(r){if(s)return;let a=r.target;if(a.classList.contains("coin")&&(a=a.parentElement),a.classList.contains("slot")&&(a=a.parentElement),a.classList.contains("column")&&a.id.startsWith("column")){const f=U(a);if(f==null)return;!he(f).state&&o=="onePlayer"&&he(c.spawnCoin())}else return;s||(l=="redCoin"?le(x,i=`It's <span style="color: red">reds</span> turn`,i):l=="yellowCoin"&&le(x,i=`It's <span style="color: yellow">yellows</span> turn`,i))}return[i,d]}class Re extends ee{constructor(e){super(),Z(this,e,He,qe,q,{})}}function Te(n){let e;return{c(){e=g("div"),e.innerHTML=`<a href="https://github.com/nils865/connectFour" class="footer-link svelte-18p7lcc">Repository</a> 
	<a href="https://github.com/nils865" class="footer-link svelte-18p7lcc">Author</a> 
	<a href="https://nils865.github.io" class="footer-link svelte-18p7lcc">Website</a>`,u(e,"class","footer svelte-18p7lcc")},m(t,i){B(t,e,i)},p:h,i:h,o:h,d(t){t&&I(e)}}}class ze extends ee{constructor(e){super(),Z(this,e,null,Te,q,{})}}function Ye(n){let e,t,i,l,s,o,c,d,r,a,f,w,C,v,R,ne;return a=new Re({}),C=new ze({}),{c(){e=g("div"),t=g("div"),i=g("img"),s=j(),o=g("select"),c=g("option"),c.textContent="2p",d=g("option"),d.textContent="1p",r=j(),de(a.$$.fragment),f=j(),w=g("footer"),de(C.$$.fragment),u(i,"id","refresh"),Le(i.src,l="./img/refresh.svg")||u(i,"src",l),u(i,"alt","refresh"),u(i,"draggable","false"),u(i,"class","svelte-x3jned"),c.__value="twoPlayer",c.value=c.__value,d.__value="onePlayer",d.value=d.__value,u(o,"name","mode"),u(o,"id","mode"),u(o,"class","svelte-x3jned"),n[0]===void 0&&P(()=>n[3].call(o)),u(t,"id","globalHead"),u(t,"class","svelte-x3jned"),u(w,"class","svelte-x3jned"),u(e,"id","mainPage"),u(e,"class","svelte-x3jned")},m(_,T){B(_,e,T),m(e,t),m(t,i),m(t,s),m(t,o),m(o,c),m(o,d),se(o,n[0]),m(e,r),V(a,e,null),m(e,f),m(e,w),V(C,w,null),v=!0,R||(ne=[G(i,"click",n[1]),G(o,"change",n[2]),G(o,"change",n[3])],R=!0)},p(_,[T]){T&1&&se(o,_[0])},i(_){v||(K(a.$$.fragment,_),K(C.$$.fragment,_),v=!0)},o(_){ce(a.$$.fragment,_),ce(C.$$.fragment,_),v=!1},d(_){_&&I(e),J(a),J(C),R=!1,W(ne)}}}function Ke(n,e,t){let i;A(n,Q,c=>t(0,i=c));const l=()=>ue(),s=()=>ue();function o(){i=Ae(this),Q.set(i)}return[i,l,s,o]}class Ve extends ee{constructor(e){super(),Z(this,e,Ke,Ye,q,{})}}new Ve({target:document.getElementById("app")});
